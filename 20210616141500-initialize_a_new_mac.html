<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<!-- 2021-07-11 Sun 15:41 -->
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Initialize a new mac</title>
<meta name="generator" content="Org Mode" />
<link rel="stylesheet" href="style.css" type="text/css"/><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0">
</head>
<body>
<div id="content" class="content">
<h1 class="title">Initialize a new mac</h1>
<div id="table-of-contents" role="doc-toc">
<h2>Table of Contents</h2>
<div id="text-table-of-contents" role="doc-toc">
<ul>
<li><a href="#orgaafa50e">1. Manual</a>
<ul>
<li><a href="#orgd0919b2">1.1. xcode</a></li>
<li><a href="#org668e8b1">1.2. Surge3</a></li>
<li><a href="#org200813d">1.3. Iterm2</a></li>
<li><a href="#org2bacbed">1.4. better touch tool3</a></li>
<li><a href="#org9ce7717">1.5. alfred3</a></li>
<li><a href="#orgbf69e07">1.6. firefox configuration, chrome</a></li>
<li><a href="#orgcba1992">1.7. rime</a></li>
</ul>
</li>
<li><a href="#orge875e9b">2. Install Nix</a>
<ul>
<li><a href="#org0e36ded">2.1. Prepare Disk</a></li>
<li><a href="#org72a764a">2.2. Install</a></li>
<li><a href="#orgd0020f1">2.3. Install git</a></li>
<li><a href="#org53e5f51">2.4. Install nix-darwin</a></li>
<li><a href="#org6b2321d">2.5. Install dotfiles</a></li>
<li><a href="#org4b17dfa">2.6. FAQ</a>
<ul>
<li><a href="#orgf2c4793">2.6.1. opening lock file '/nix/store/*.lock': Permission denied</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#org6c3bbcd">3. Brew</a></li>
<li><a href="#orgf54b484">4. nvm (disabled)</a></li>
</ul>
</div>
</div>

<div id="outline-container-orgaafa50e" class="outline-2">
<h2 id="orgaafa50e"><span class="section-number-2">1.</span> Manual</h2>
<div class="outline-text-2" id="text-1">
</div>
<div id="outline-container-orgd0919b2" class="outline-3">
<h3 id="orgd0919b2"><span class="section-number-3">1.1.</span> xcode</h3>
</div>
<div id="outline-container-org668e8b1" class="outline-3">
<h3 id="org668e8b1"><span class="section-number-3">1.2.</span> <a href="https://manual.nssurge.com/release-note/surge-mac.html">Surge</a>3</h3>
</div>
<div id="outline-container-org200813d" class="outline-3">
<h3 id="org200813d"><span class="section-number-3">1.3.</span> <a href="https://iterm2.com">Iterm2</a></h3>
</div>
<div id="outline-container-org2bacbed" class="outline-3">
<h3 id="org2bacbed"><span class="section-number-3">1.4.</span> <a href="https://folivora.ai/">better touch tool</a>3</h3>
</div>
<div id="outline-container-org9ce7717" class="outline-3">
<h3 id="org9ce7717"><span class="section-number-3">1.5.</span> <a href="https://www.alfredapp.com/help/v3/">alfred3</a></h3>
</div>
<div id="outline-container-orgbf69e07" class="outline-3">
<h3 id="orgbf69e07"><span class="section-number-3">1.6.</span> <a href="20210601165700-firefox_configuration.html">firefox configuration</a>, chrome</h3>
</div>
<div id="outline-container-orgcba1992" class="outline-3">
<h3 id="orgcba1992"><span class="section-number-3">1.7.</span> <a href="https://rime.im/">rime</a></h3>
<div class="outline-text-3" id="text-1-7">
<div class="org-src-container">
<pre class="src src-sh"><span style="color: #9999bb;">wget</span> <span style="color: #a0d6e0;">https://github.com/rime/librime/releases/download/1.5.3/rime-1.5.3-osx.zip</span>
<span style="color: #c0a7bd;">unzip</span> <span style="color: #c0afa7;">rime-1.5.3-osx.zip</span> <span style="color: #c0afa7;">-d</span> <span style="color: #a3e0a0;">librime</span>
<span style="color: #b6a0e0;">mkdir</span> <span style="color: #e0d0a0;">-p</span> <span style="color: #bba699;">~/.local/share</span>
<span style="color: #9999bb;">cp</span> <span style="color: #b6a0e0;">-a</span> <span style="color: #c0a7bd;">librime/dist</span> <span style="color: #e0a0bc;">~/.local/share/librime</span>
</pre>
</div>
</div>
</div>
</div>
<div id="outline-container-orge875e9b" class="outline-2">
<h2 id="orge875e9b"><span class="section-number-2">2.</span> Install Nix</h2>
<div class="outline-text-2" id="text-2">
</div>
<div id="outline-container-org0e36ded" class="outline-3">
<h3 id="org0e36ded"><span class="section-number-3">2.1.</span> Prepare Disk</h3>
<div class="outline-text-3" id="text-2-1">
<p>
<a href="https://stackoverflow.com/questions/67115985/error-installing-nix-on-macos-catalina-and-big-sur-on-filevault-encrypted-boot-v">Error installing Nix on FileVault-encrypted boot volume</a>
</p>

<p>
Create another Volume on your Disk for Nix:
</p>
<div class="org-src-container">
<pre class="src src-sh"><span style="color: #c0a7bd;">sudo</span> <span style="color: #bba699;">diskutil</span> <span style="color: #e0a0bc;">apfs</span> <span style="color: #99bbb4;">addVolume</span> <span style="color: #c0afa7;">disk1</span> <span style="color: #f1fa8c;">'APFS'</span> <span style="color: #e0d0a0;">nix</span>
</pre>
</div>

<p>
Encrypt Disk:
</p>
<div class="org-src-container">
<pre class="src src-sh"><span style="color: #c0a7bd;">sudo</span> <span style="color: #bba699;">diskutil</span> <span style="color: #e0a0bc;">apfs</span> <span style="color: #99bbb4;">encryptvolume</span> <span style="color: #9999bb;">disk1s7</span> <span style="color: #c0a7bd;">-user</span> <span style="color: #a7aac0;">disk</span>
</pre>
</div>

<p>
Setup Mount Point:
</p>
<div class="org-src-container">
<pre class="src src-sh"><span style="color: #c0a7bd;">sudo</span> <span style="color: #b3c0a7;">bash</span> <span style="color: #9999bb;">-c</span> <span style="color: #f1fa8c;">'echo nix &gt;&gt; /etc/synthetic.conf'</span>
<span style="color: #c0a7bd;">sudo</span> <span style="color: #b6a0e0;">vifs</span>
<span style="color: #bba699;">diskutil</span> <span style="color: #9999bb;">info</span> <span style="color: #a3e0a0;">/dev/disk1s7</span> | <span style="color: #a3e0a0;">grep</span> <span style="color: #a7c0b9;">UUID</span>
<span style="color: #8be9fd; background-color: #323440;"># </span><span style="color: #8be9fd; background-color: #323440;">UUID= /nix apfs  rw</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-org72a764a" class="outline-3">
<h3 id="org72a764a"><span class="section-number-3">2.2.</span> Install</h3>
<div class="outline-text-3" id="text-2-2">
<div class="org-src-container">
<pre class="src src-sh"><span style="color: #bba699;">curl</span> <span style="color: #a7aac0;">-L</span> <span style="color: #e0d0a0;">https://nixos.org/nix/install</span> <span style="color: #bb99b4;">-o</span> <span style="color: #9999bb;">installNix.sh</span>
<span style="color: #a7c0b9;">sh</span> &lt;<span style="color: #9999bb;">installNix.sh</span> <span style="color: #a6bb99;">--daemon</span>
<span style="color: #8be9fd; background-color: #323440;"># </span><span style="color: #8be9fd; background-color: #323440;">sh &lt;(curl -L https://nixos.org/nix/install) --daemon</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-orgd0020f1" class="outline-3">
<h3 id="orgd0020f1"><span class="section-number-3">2.3.</span> Install git</h3>
<div class="outline-text-3" id="text-2-3">
<div class="org-src-container">
<pre class="src src-sh"><span style="color: #a7aac0;">nix-env</span> <span style="color: #c0a7bd;">-qaP</span> <span style="color: #b6a0e0;">--description</span> <span style="color: #a7aac0;">git</span>
<span style="color: #a7aac0;">nix-env</span> <span style="color: #a0d6e0;">-iA</span> <span style="color: #b6a0e0;">nixpkgs.gitFull</span>
<span style="color: #a6bb99;">ssh-keygen</span> <span style="color: #e0a0bc;">-t</span> <span style="color: #a7c0b9;">ed25519</span> <span style="color: #bb99b4;">-C</span> <span style="color: #f1fa8c;">"kkxandeer@gmail.com"</span>
<span style="color: #bb99b4;">vi</span> <span style="color: #b6a0e0;">~/.ssh/config</span>
<span style="color: #a0d6e0;">pbcopy</span> &lt; <span style="color: #a7c0b9;">~/.ssh/id_ed25519.pub</span>
</pre>
</div>

<p>
Copy ssh pub to <a href="https://github.com/settings/keys">Github</a>.
</p>

<p>
Copy below to <code>~/.ssh/config</code>.
</p>
<pre class="example" id="org0b74b0b">
Host *
  IgnoreUnknown UseKeychain
  AddKeysToAgent yes
  UseKeychain yes
  IdentityFile ~/.ssh/id_ed25519
</pre>
</div>
</div>

<div id="outline-container-org53e5f51" class="outline-3">
<h3 id="org53e5f51"><span class="section-number-3">2.4.</span> Install nix-darwin</h3>
<div class="outline-text-3" id="text-2-4">
<div class="org-src-container">
<pre class="src src-#+begin_src">nix-build https://github.com/LnL7/nix-darwin/archive/master.tar.gz -A installer
./result/bin/darwin-installer
rm -rf result
</pre>
</div>
</div>
</div>
<div id="outline-container-org6b2321d" class="outline-3">
<h3 id="org6b2321d"><span class="section-number-3">2.5.</span> Install dotfiles</h3>
<div class="outline-text-3" id="text-2-5">
<div class="org-src-container">
<pre class="src src-sh"><span style="color: #a7aac0;">nix-env</span> <span style="color: #a6bb99;">-i</span> <span style="color: #b3c0a7;">stow</span>
<span style="color: #b6a0e0;">mkdir</span> <span style="color: #e0d0a0;">-p</span> <span style="color: #b6a0e0;">~/projects/personal</span>
<span style="color: #ffb86c;">cd</span> <span style="color: #b6a0e0;">~/projects/personal</span>
<span style="color: #a7aac0;">git</span> <span style="color: #c0a7bd;">clone</span> <span style="color: #a7aac0;">git</span>@<span style="color: #b3c0a7;">github.com:xandeer/dotfiles.git</span>
<span style="color: #ffb86c;">cd</span> <span style="color: #b3c0a7;">dotfiles</span>
<span style="color: #a6bb99;">make</span> <span style="color: #a6bb99;">install</span>
<span style="color: #a0d6e0;">darwin-rebuild</span> <span style="color: #a0d6e0;">switch</span>
<span style="color: #ffb86c;">cd</span> <span style="color: #a0d6e0;">~</span>
<span style="color: #99bbb4;">mr</span> <span style="color: #99bbb4;">-j</span> <span style="color: #b3c0a7;">9</span> <span style="color: #b3c0a7;">update</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-org4b17dfa" class="outline-3">
<h3 id="org4b17dfa"><span class="section-number-3">2.6.</span> FAQ</h3>
<div class="outline-text-3" id="text-2-6">
</div>
<div id="outline-container-orgf2c4793" class="outline-4">
<h4 id="orgf2c4793"><span class="section-number-4">2.6.1.</span> opening lock file '/nix/store/*.lock': Permission denied</h4>
<div class="outline-text-4" id="text-2-6-1">
<div class="org-src-container">
<pre class="src src-sh"><span style="color: #c0a7bd;">sudo</span> <span style="color: #e0d0a0;">chown</span> <span style="color: #a7aac0;">-R</span> <span style="color: #bba699;">kevin:staff</span> <span style="color: #c0a7bd;">/nix</span>
</pre>
</div>
</div>
</div>
</div>
</div>
<div id="outline-container-org6c3bbcd" class="outline-2">
<h2 id="org6c3bbcd"><span class="section-number-2">3.</span> Brew</h2>
<div class="outline-text-2" id="text-3">
<div class="org-src-container">
<pre class="src src-sh"><span style="color: #a7c0b9;">/bin/bash</span> <span style="color: #9999bb;">-c</span> <span style="color: #f1fa8c;">"$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/master/install.sh)"</span>
</pre>
</div>

<div class="org-src-container">
<pre class="src src-sh"><span style="color: #9999bb;">brew</span> <span style="color: #a6bb99;">tap</span> <span style="color: #bba699;">git-chglog/git-chglog</span>
<span style="color: #9999bb;">brew</span> <span style="color: #a6bb99;">tap</span> <span style="color: #c0a7bd;">d12frosted/emacs-plus</span>
<span style="color: #9999bb;">brew</span> <span style="color: #a6bb99;">install</span> <span style="color: #a0d6e0;">trash</span> <span style="color: #9999bb;">onefetch</span> <span style="color: #9999bb;">emacs-plus</span>@<span style="color: #a3e0a0;">27</span> <span style="color: #9999bb;">ffmpeg</span> <span style="color: #b6a0e0;">prettyping</span> <span style="color: #e0d0a0;">sdcv</span> <span style="color: #a7c0b9;">ranger</span> <span style="color: #a0d6e0;">git-chglog</span> <span style="color: #a7c0b9;">gpg2</span> <span style="color: #e0a0bc;">tdlib</span> <span style="color: #bb99b4;">node</span> <span style="color: #b6a0e0;">dust</span> <span style="color: #bb99b4;">kotlin</span>
<span style="color: #9999bb;">brew</span> <span style="color: #bb99b4;">services</span> <span style="color: #99bbb4;">start</span> <span style="color: #a7aac0;">d12frosted/emacs-plus/emacs-plus</span>@<span style="color: #a3e0a0;">27</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-orgf54b484" class="outline-2">
<h2 id="orgf54b484"><span class="section-number-2">4.</span> nvm (disabled)</h2>
<div class="outline-text-2" id="text-4">
<div class="org-src-container">
<pre class="src src-sh"><span style="color: #bba699;">curl</span> <span style="color: #e0a0bc;">-o-</span> <span style="color: #c0a7bd;">https://raw.githubusercontent.com/nvm-sh/nvm/v0.38.0/install.sh</span> | <span style="color: #b3c0a7;">bash</span>
<span style="color: #e0d0a0;">src</span>
<span style="color: #a3e0a0;">nvm</span> <span style="color: #a6bb99;">install</span> <span style="color: #bb99b4;">node</span>
</pre>
</div>
</div>
</div>
</div>
<div id="postamble" class="status">
<p class="date">Created: 2021-07-11 Sun 15:41</p>
<p class="validation"><a href="https://validator.w3.org/check?uri=referer">Validate</a></p>
</div>
</body>
</html>
