<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<!-- 2022-10-12 Wed 09:08 -->
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Initialize a new mac</title>
<meta name="generator" content="Org Mode" />
<link rel="stylesheet" href="static/x.css" type="text/css"/><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0">
</head>
<body>
<div id="content" class="content">
<h1 class="title">Initialize a new mac</h1>
<div id="table-of-contents" role="doc-toc">
<h2>Table of Contents</h2>
<div id="text-table-of-contents" role="doc-toc">
<ul>
<li><a href="#orge22c5cf">1. Prepare</a></li>
<li><a href="#org22c3a12">2. Manual</a>
<ul>
<li><a href="#orga69874c">2.1. xcode</a></li>
<li><a href="#orgd8709ab">2.2. <del>better touch tool3(not needed)</del></a></li>
<li><a href="#orgcb65a8c">2.3. firefox configuration, chrome</a></li>
<li><a href="#org1466da8">2.4. instead by the latter with brew cask</a>
<ul>
<li><a href="#orgd4db943">2.4.1. ShowyEdge</a></li>
<li><a href="#org5ce6b57">2.4.2. Surge3 / ClashX</a></li>
<li><a href="#org615a60c">2.4.3. alfred3 / raycast</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#org4f7e25d">3. Install Nix</a>
<ul>
<li><a href="#org4ef7543">3.1. Install</a></li>
<li><a href="#org3bb6487">3.2. Install git</a></li>
<li><a href="#orga560eca">3.3. Install nix-darwin</a></li>
<li><a href="#org88f3664">3.4. Install dotfiles</a></li>
<li><a href="#org8ec4fd6">3.5. FAQ</a>
<ul>
<li><a href="#org26ddc98">3.5.1. opening lock file '/nix/store/*.lock': Permission denied</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#org34cfe9a">4. Brew</a>
<ul>
<li><a href="#org060f664">4.1. Karabiner</a></li>
<li><a href="#org58625d0">4.2. faq</a>
<ul>
<li><a href="#orgd942add">4.2.1. fatal: could not resolve head to a revision</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#orgb8e73cc">5. nvm (disabled)</a></li>
<li><a href="#orgfb7d91e">6. tdlib telega</a></li>
<li><a href="#org8b73a04">7. emacs</a>
<ul>
<li><a href="#orga3d6c6d">7.1. Install icon fonts</a></li>
</ul>
</li>
</ul>
</div>
</div>

<div id="outline-container-orge22c5cf" class="outline-2">
<h2 id="orge22c5cf"><span class="section-number-2">1.</span> Prepare</h2>
<div class="outline-text-2" id="text-1">
<div class="org-src-container">
<pre class="src src-sh"><span style="font-weight: bold;">cd</span>
mkdir projects
<span style="font-weight: bold;">cd</span> projects
mkdir personal others xmind
touch xmind/.gitconfig
</pre>
</div>

<pre class="example" id="orgf93f82a">
[user]
  email = kevin@xmind.app
</pre>
</div>
</div>
<div id="outline-container-org22c3a12" class="outline-2">
<h2 id="org22c3a12"><span class="section-number-2">2.</span> Manual</h2>
<div class="outline-text-2" id="text-2">
</div>
<div id="outline-container-orga69874c" class="outline-3">
<h3 id="orga69874c"><span class="section-number-3">2.1.</span> xcode</h3>
</div>
<div id="outline-container-orgd8709ab" class="outline-3">
<h3 id="orgd8709ab"><span class="section-number-3">2.2.</span> <del><a href="https://folivora.ai/">better touch tool</a>3(not needed)</del></h3>
</div>
<div id="outline-container-orgcb65a8c" class="outline-3">
<h3 id="orgcb65a8c"><span class="section-number-3">2.3.</span> <a href="20210601165700-firefox_configuration.html#ID-3165C7DC-0883-464C-9AFC-2E98AB4C946D">firefox configuration</a>, chrome</h3>
</div>
<div id="outline-container-org1466da8" class="outline-3">
<h3 id="org1466da8"><span class="section-number-3">2.4.</span> instead by the latter with brew cask</h3>
<div class="outline-text-3" id="text-2-4">
</div>
<div id="outline-container-orgd4db943" class="outline-4">
<h4 id="orgd4db943"><span class="section-number-4">2.4.1.</span> <a href="https://showyedge.pqrs.org/">ShowyEdge</a></h4>
</div>
<div id="outline-container-org5ce6b57" class="outline-4">
<h4 id="org5ce6b57"><span class="section-number-4">2.4.2.</span> <a href="https://manual.nssurge.com/release-note/surge-mac.html">Surge</a>3 / <a href="https://github.com/yichengchen/clashX">ClashX</a></h4>
</div>
<div id="outline-container-org615a60c" class="outline-4">
<h4 id="org615a60c"><span class="section-number-4">2.4.3.</span> <a href="https://www.alfredapp.com/help/v3/">alfred3</a> / <a href="https://www.raycast.com/">raycast</a></h4>
</div>
</div>
</div>
<div id="outline-container-org4f7e25d" class="outline-2">
<h2 id="org4f7e25d"><span class="section-number-2">3.</span> Install Nix</h2>
<div class="outline-text-2" id="text-3">
</div>
<div id="outline-container-org4ef7543" class="outline-3">
<h3 id="org4ef7543"><span class="section-number-3">3.1.</span> Install</h3>
<div class="outline-text-3" id="text-3-1">
<div class="org-src-container">
<pre class="src src-sh">sh &lt;(curl -L https://nixos.org/nix/install)
</pre>
</div>
</div>
</div>
<div id="outline-container-org3bb6487" class="outline-3">
<h3 id="org3bb6487"><span class="section-number-3">3.2.</span> Install git</h3>
<div class="outline-text-3" id="text-3-2">
<div class="org-src-container">
<pre class="src src-sh">nix-env -qaP --description git
nix-env -iA nixpkgs.gitFull
nix-env -i corkscrew
ssh-keygen -t ed25519 -C <span style="font-style: italic;">"kkxandeer@gmail.com"</span>
vi ~/.ssh/config
pbcopy &lt; ~/.ssh/id_ed25519.pub
</pre>
</div>

<p>
Copy ssh pub to <a href="https://github.com/settings/keys">Github</a>.
</p>

<p>
<del>Copy below to <code>~/.ssh/config</code>.</del> This has migrated to dots.
</p>
<pre class="example" id="orgbe6ce40">
Host *
  IgnoreUnknown UseKeychain
  AddKeysToAgent yes
  UseKeychain yes
  IdentityFile ~/.ssh/id_ed25519
  ForwardAgent yes
  ProxyCommand ~/.nix-profile/bin/corkscrew localhost 8010 %h %p  ~/.ssh/id_ed25519
</pre>
</div>
</div>
<div id="outline-container-orga560eca" class="outline-3">
<h3 id="orga560eca"><span class="section-number-3">3.3.</span> Install nix-darwin</h3>
<div class="outline-text-3" id="text-3-3">
<div class="org-src-container">
<pre class="src src-#+begin_src">nix-build https://github.com/LnL7/nix-darwin/archive/master.tar.gz -A installer
./result/bin/darwin-installer
rm -rf result
</pre>
</div>
</div>
</div>
<div id="outline-container-org88f3664" class="outline-3">
<h3 id="org88f3664"><span class="section-number-3">3.4.</span> Install dotfiles</h3>
<div class="outline-text-3" id="text-3-4">
<div class="org-src-container">
<pre class="src src-sh">nix-env -i stow
mkdir -p ~/projects/personal
<span style="font-weight: bold;">cd</span> ~/projects/personal
git clone git@github.com:xandeer/dotfiles.git
<span style="font-weight: bold;">cd</span> dotfiles
<span style="font-weight: bold; font-style: italic;"># </span><span style="font-weight: bold; font-style: italic;">after gpg2 installed</span>
make dedot
make install
darwin-rebuild switch
<span style="font-weight: bold;">cd</span> ~
mr -j 9 update
</pre>
</div>
</div>
</div>
<div id="outline-container-org8ec4fd6" class="outline-3">
<h3 id="org8ec4fd6"><span class="section-number-3">3.5.</span> FAQ</h3>
<div class="outline-text-3" id="text-3-5">
</div>
<div id="outline-container-org26ddc98" class="outline-4">
<h4 id="org26ddc98"><span class="section-number-4">3.5.1.</span> opening lock file '/nix/store/*.lock': Permission denied</h4>
<div class="outline-text-4" id="text-3-5-1">
<div class="org-src-container">
<pre class="src src-sh">sudo chown -R kevin:staff /nix
</pre>
</div>
</div>
</div>
</div>
</div>
<div id="outline-container-org34cfe9a" class="outline-2">
<h2 id="org34cfe9a"><span class="section-number-2">4.</span> Brew</h2>
<div class="outline-text-2" id="text-4">
<div class="org-src-container">
<pre class="src src-sh">/bin/bash -c <span style="font-style: italic;">"$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/HEAD/uninstall.sh)"</span>

/bin/bash -c <span style="font-style: italic;">"$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/HEAD/install.sh)"</span>

<span style="font-weight: bold; font-style: italic;"># </span><span style="font-weight: bold; font-style: italic;">https://homebrew-file.readthedocs.io/en/latest/installation.html</span>
/bin/bash -c <span style="font-style: italic;">"$(curl -fsSL https://raw.github.com/rcmdnk/homebrew-file/install/install.sh)"</span>

<span style="font-weight: bold;">echo</span> <span style="font-style: italic;">'eval "$(/opt/homebrew/bin/brew shellenv)"'</span> &gt;&gt; ~/.zprofile
<span style="font-weight: bold;">eval</span> <span style="font-style: italic;">"$(/opt/homebrew/bin/brew shellenv)"</span>

brew file install
</pre>
</div>
</div>
<div id="outline-container-org060f664" class="outline-3">
<h3 id="org060f664"><span class="section-number-3">4.1.</span> Karabiner</h3>
<div class="outline-text-3" id="text-4-1">
<div class="org-src-container">
<pre class="src src-sh">brew services start goku
</pre>
</div>
</div>
</div>
<div id="outline-container-org58625d0" class="outline-3">
<h3 id="org58625d0"><span class="section-number-3">4.2.</span> faq</h3>
<div class="outline-text-3" id="text-4-2">
</div>
<div id="outline-container-orgd942add" class="outline-4">
<h4 id="orgd942add"><span class="section-number-4">4.2.1.</span> fatal: could not resolve head to a revision</h4>
<div class="outline-text-4" id="text-4-2-1">
<div class="org-src-container">
<pre class="src src-sh">git -C $(brew --repository homebrew/core) checkout master
<span style="font-weight: bold; font-style: italic;"># </span><span style="font-weight: bold; font-style: italic;">or</span>
git -C $(brew --repository homebrew/core) reset --hard HEAD
</pre>
</div>
</div>
</div>
</div>
</div>
<div id="outline-container-orgb8e73cc" class="outline-2">
<h2 id="orgb8e73cc"><span class="section-number-2">5.</span> nvm (disabled)</h2>
<div class="outline-text-2" id="text-5">
<div class="org-src-container">
<pre class="src src-sh">curl -o- https://raw.githubusercontent.com/nvm-sh/nvm/v0.38.0/install.sh | bash
src
nvm install node
</pre>
</div>
</div>
</div>
<div id="outline-container-orgfb7d91e" class="outline-2">
<h2 id="orgfb7d91e"><span class="section-number-2">6.</span> tdlib telega</h2>
<div class="outline-text-2" id="text-6">
<div class="org-src-container">
<pre class="src src-shell">g clone https://github.com/tdlib/td.git
<span style="font-weight: bold;">cd</span> td
md build; <span style="font-weight: bold;">cd</span> build
<span style="font-weight: bold; font-style: italic;"># </span><span style="font-weight: bold; font-style: italic;">cmake -DCMAKE_BUILD_TYPE=Release -DOPENSSL_ROOT_DIR=/usr/local/opt/openssl/ -DZLIB_LIBRARY=/usr/local/opt/zlib/lib/ -DZLIB_INCLUDE_DIR=/usr/local/opt/zlib/include ..</span>
cmake -DCMAKE_BUILD_TYPE=Release -DOPENSSL_ROOT_DIR=/usr/local/opt/openssl/ ..
cmake -DCMAKE_BUILD_TYPE=Release -DOPENSSL_ROOT_DIR=/opt/homebrew/opt/openssl@1.1/ ..
make -j8
rm /usr/local/lib/libtdjson.*
sudo make install
<span style="font-weight: bold;">cd</span> ~/.emacs.d/straight/repos/telega.el
git checkout master
git pull
</pre>
</div>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(telega-server-build)
</pre>
</div>
</div>
</div>
<div id="outline-container-org8b73a04" class="outline-2">
<h2 id="org8b73a04"><span class="section-number-2">7.</span> emacs</h2>
<div class="outline-text-2" id="text-7">
</div>
<div id="outline-container-orga3d6c6d" class="outline-3">
<h3 id="orga3d6c6d"><span class="section-number-3">7.1.</span> Install icon fonts</h3>
<div class="outline-text-3" id="text-7-1">
<div class="org-src-container">
<pre class="src src-emacs-lisp">(all-the-icons-install-fonts)
</pre>
</div>
</div>
</div>
</div>
</div>
<div id="postamble" class="status">
<div class="links"><a href="#content">T</a><a href="index.html">H</a><a id="share-img">I</a><a href="20210629191000-000_index.html">0</a></div><script src="static/dom2img.min.js" type="text/javascript"></script><script src="static/x.js" type="text/javascript"></script>
</div>
</body>
</html>
