<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<!-- 2021-08-08 Sun 14:23 -->
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Initialize a new mac</title>
<meta name="generator" content="Org mode" />
<link rel="stylesheet" href="static/x.css" type="text/css"/><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0">
<script type="text/javascript">
// @license magnet:?xt=urn:btih:e95b018ef3580986a04669f1b5879592219e2a7a&dn=public-domain.txt Public Domain
<!--/*--><![CDATA[/*><!--*/
     function CodeHighlightOn(elem, id)
     {
       var target = document.getElementById(id);
       if(null != target) {
         elem.classList.add("code-highlighted");
         target.classList.add("code-highlighted");
       }
     }
     function CodeHighlightOff(elem, id)
     {
       var target = document.getElementById(id);
       if(null != target) {
         elem.classList.remove("code-highlighted");
         target.classList.remove("code-highlighted");
       }
     }
    /*]]>*///-->
// @license-end
</script>
</head>
<body>
<div id="content">
<h1 class="title">Initialize a new mac</h1>
<div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#org0e7a58c">1. Manual</a>
<ul>
<li><a href="#org4b54beb">1.1. xcode</a></li>
<li><a href="#orgf6d0ab8">1.2. Surge3</a></li>
<li><a href="#orga873e58">1.3. Iterm2</a></li>
<li><a href="#org6dd25a6">1.4. better touch tool3</a></li>
<li><a href="#org5a43476">1.5. alfred3</a></li>
<li><a href="#org1418cfb">1.6. firefox configuration, chrome</a></li>
<li><a href="#orge81c393">1.7. rime</a></li>
</ul>
</li>
<li><a href="#org9fc8e81">2. Install Nix</a>
<ul>
<li><a href="#org1cc1639">2.1. Prepare Disk</a></li>
<li><a href="#org822a514">2.2. Install</a></li>
<li><a href="#orgf9e3f9c">2.3. Install git</a></li>
<li><a href="#org1c176cd">2.4. Install nix-darwin</a></li>
<li><a href="#orgf69a426">2.5. Install dotfiles</a></li>
<li><a href="#org43abaaa">2.6. FAQ</a>
<ul>
<li><a href="#org1ea5ebf">2.6.1. opening lock file '/nix/store/*.lock': Permission denied</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#orge46d0dd">3. Brew</a></li>
<li><a href="#org55bdd01">4. nvm (disabled)</a></li>
</ul>
</div>
</div>

<div id="outline-container-org0e7a58c" class="outline-2">
<h2 id="org0e7a58c"><span class="section-number-2">1</span> Manual</h2>
<div class="outline-text-2" id="text-1">
</div>
<div id="outline-container-org4b54beb" class="outline-3">
<h3 id="org4b54beb"><span class="section-number-3">1.1</span> xcode</h3>
</div>
<div id="outline-container-orgf6d0ab8" class="outline-3">
<h3 id="orgf6d0ab8"><span class="section-number-3">1.2</span> <a href="https://manual.nssurge.com/release-note/surge-mac.html">Surge</a>3</h3>
</div>
<div id="outline-container-orga873e58" class="outline-3">
<h3 id="orga873e58"><span class="section-number-3">1.3</span> <a href="https://iterm2.com">Iterm2</a></h3>
</div>
<div id="outline-container-org6dd25a6" class="outline-3">
<h3 id="org6dd25a6"><span class="section-number-3">1.4</span> <a href="https://folivora.ai/">better touch tool</a>3</h3>
</div>
<div id="outline-container-org5a43476" class="outline-3">
<h3 id="org5a43476"><span class="section-number-3">1.5</span> <a href="https://www.alfredapp.com/help/v3/">alfred3</a></h3>
</div>
<div id="outline-container-org1418cfb" class="outline-3">
<h3 id="org1418cfb"><span class="section-number-3">1.6</span> <a href="20210601165700-firefox_configuration.html">firefox configuration</a>, chrome</h3>
</div>
<div id="outline-container-orge81c393" class="outline-3">
<h3 id="orge81c393"><span class="section-number-3">1.7</span> <a href="https://rime.im/">rime</a></h3>
<div class="outline-text-3" id="text-1-7">
<div class="org-src-container">
<pre class="src src-sh">wget https://github.com/rime/librime/releases/download/1.7.3/rime-1.7.3-osx.zip
unzip rime-1.7.3-osx.zip -d librime
mkdir -p ~/.local/share
cp -a librime/dist ~/.local/share/librime
</pre>
</div>
</div>
</div>
</div>
<div id="outline-container-org9fc8e81" class="outline-2">
<h2 id="org9fc8e81"><span class="section-number-2">2</span> Install Nix</h2>
<div class="outline-text-2" id="text-2">
</div>
<div id="outline-container-org1cc1639" class="outline-3">
<h3 id="org1cc1639"><span class="section-number-3">2.1</span> Prepare Disk</h3>
<div class="outline-text-3" id="text-2-1">
<p>
<a href="https://stackoverflow.com/questions/67115985/error-installing-nix-on-macos-catalina-and-big-sur-on-filevault-encrypted-boot-v">Error installing Nix on FileVault-encrypted boot volume</a>
</p>

<p>
Create another Volume on your Disk for Nix:
</p>
<div class="org-src-container">
<pre class="src src-sh">sudo diskutil apfs addVolume disk1 'APFS' nix
</pre>
</div>

<p>
Encrypt Disk:
</p>
<div class="org-src-container">
<pre class="src src-sh">sudo diskutil apfs encryptvolume disk1s7 -user disk
</pre>
</div>

<p>
Setup Mount Point:
</p>
<div class="org-src-container">
<pre class="src src-sh">sudo bash -c 'echo nix &gt;&gt; /etc/synthetic.conf'
sudo vifs
diskutil info /dev/disk1s7 | grep UUID
# UUID= /nix apfs  rw
</pre>
</div>
</div>
</div>
<div id="outline-container-org822a514" class="outline-3">
<h3 id="org822a514"><span class="section-number-3">2.2</span> Install</h3>
<div class="outline-text-3" id="text-2-2">
<div class="org-src-container">
<pre class="src src-sh">curl -L https://nixos.org/nix/install -o installNix.sh
sh &lt;installNix.sh --daemon
# sh &lt;(curl -L https://nixos.org/nix/install) --daemon
</pre>
</div>
</div>
</div>
<div id="outline-container-orgf9e3f9c" class="outline-3">
<h3 id="orgf9e3f9c"><span class="section-number-3">2.3</span> Install git</h3>
<div class="outline-text-3" id="text-2-3">
<div class="org-src-container">
<pre class="src src-sh">nix-env -qaP --description git
nix-env -iA nixpkgs.gitFull
ssh-keygen -t ed25519 -C "kkxandeer@gmail.com"
vi ~/.ssh/config
pbcopy &lt; ~/.ssh/id_ed25519.pub
</pre>
</div>

<p>
Copy ssh pub to <a href="https://github.com/settings/keys">Github</a>.
</p>

<p>
Copy below to <code>~/.ssh/config</code>.
</p>
<pre class="example" id="org051ca7a">
Host *
  IgnoreUnknown UseKeychain
  AddKeysToAgent yes
  UseKeychain yes
  IdentityFile ~/.ssh/id_ed25519
</pre>
</div>
</div>

<div id="outline-container-org1c176cd" class="outline-3">
<h3 id="org1c176cd"><span class="section-number-3">2.4</span> Install nix-darwin</h3>
<div class="outline-text-3" id="text-2-4">
<div class="org-src-container">
<pre class="src src-#+begin_src">nix-build https://github.com/LnL7/nix-darwin/archive/master.tar.gz -A installer
./result/bin/darwin-installer
rm -rf result
</pre>
</div>
</div>
</div>
<div id="outline-container-orgf69a426" class="outline-3">
<h3 id="orgf69a426"><span class="section-number-3">2.5</span> Install dotfiles</h3>
<div class="outline-text-3" id="text-2-5">
<div class="org-src-container">
<pre class="src src-sh">nix-env -i stow
mkdir -p ~/projects/personal
cd ~/projects/personal
git clone git@github.com:xandeer/dotfiles.git
cd dotfiles
make install
darwin-rebuild switch
cd ~
mr -j 9 update
</pre>
</div>
</div>
</div>
<div id="outline-container-org43abaaa" class="outline-3">
<h3 id="org43abaaa"><span class="section-number-3">2.6</span> FAQ</h3>
<div class="outline-text-3" id="text-2-6">
</div>
<div id="outline-container-org1ea5ebf" class="outline-4">
<h4 id="org1ea5ebf"><span class="section-number-4">2.6.1</span> opening lock file '/nix/store/*.lock': Permission denied</h4>
<div class="outline-text-4" id="text-2-6-1">
<div class="org-src-container">
<pre class="src src-sh">sudo chown -R kevin:staff /nix
</pre>
</div>
</div>
</div>
</div>
</div>
<div id="outline-container-orge46d0dd" class="outline-2">
<h2 id="orge46d0dd"><span class="section-number-2">3</span> Brew</h2>
<div class="outline-text-2" id="text-3">
<div class="org-src-container">
<pre class="src src-sh">/bin/bash -c "$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/master/install.sh)"
</pre>
</div>

<div class="org-src-container">
<pre class="src src-sh">brew tap git-chglog/git-chglog
brew tap d12frosted/emacs-plus
brew install trash onefetch emacs-plus@27 ffmpeg prettyping sdcv ranger git-chglog gpg2 tdlib node dust kotlin
brew services start d12frosted/emacs-plus/emacs-plus@27
</pre>
</div>
</div>
</div>
<div id="outline-container-org55bdd01" class="outline-2">
<h2 id="org55bdd01"><span class="section-number-2">4</span> nvm (disabled)</h2>
<div class="outline-text-2" id="text-4">
<div class="org-src-container">
<pre class="src src-sh">curl -o- https://raw.githubusercontent.com/nvm-sh/nvm/v0.38.0/install.sh | bash
src
nvm install node
</pre>
</div>
</div>
</div>
</div>
<div id="postamble" class="status">
<div class="links"><a href="index.html">Home</a><a href="20210629191000-000_index.html">000</a></div><script src="static/x.js" type="text/javascript"></script>
</div>
</body>
</html>
